<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Personalized Career Guidance</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='webpages.css') }}">
</head>

<body>
  <header class="navbar">
    <button class="menu-icon" onclick="openSidebar()">☰</button>
    <a class="logo" href="{{ url_for('home') }}">SKILL VISTAAR</a>
  </header>

  <nav id="sidebar" class="sidebar">
    <button class="close-btn" onclick="closeSidebar()">✕</button>
    <a href="{{ url_for('career_guidance') }}">Personalized Career Guidance</a>
    <a href="{{ url_for('skill_gap') }}">Skill Gap Analysis</a>
    <a href="{{ url_for('salary_forecasting') }}">Salary Forecasting</a>
    <a href="{{ url_for('mentorship') }}">Mentorship Program</a>
    <a href="{{ url_for('networking') }}">Networking Opportunities</a>
  </nav>

  <main class="content form-page">
    <h1>Career Guidance Quiz</h1>
    <form id="quizForm" class="form-card">
      <label>1) Which subject do you enjoy most?</label>
      <select name="q1">
        <option value="programming">Programming</option>
        <option value="design">Design & UX</option>
        <option value="math">Math & Analytics</option>
        <option value="writing">Writing & Communication</option>
      </select>

      <label>2) Work style preference</label>
      <select name="q2">
        <option value="team">Team projects</option>
        <option value="solo">Independent work</option>
        <option value="client">Client-facing</option>
      </select>

      <label>3) Do you prefer hands-on technical tasks?</label>
      <select name="q3">
        <option value="yes">Yes</option>
        <option value="no">No</option>
      </select>

      <button type="submit" class="btn">Get Recommendation</button>
    </form>

    <div id="quiz-result" class="result-card" style="display:none"></div>
  </main>

  <footer class="footer-gradient"><p>© 2025 Skill Vistaar</p></footer>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('quizForm');
      const resultDiv = document.getElementById('quiz-result');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        resultDiv.style.display = 'block';
        resultDiv.innerHTML = '<em>Processing…</em>';

        const formData = new FormData(form);
        const answers = {};
        for (const [k, v] of formData.entries()) answers[k] = v;

        try {
          const res = await fetch('/career_quiz', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({answers})
          });
          const data = await res.json();
          if (data.error) {
            resultDiv.innerHTML = `<p class="error">${data.error}</p>`;
            return;
          }
          resultDiv.innerHTML = `
            <h3>Recommended Career: ${data.recommended_career}</h3>
            <p><strong>Why:</strong> ${data.reason}</p>
            <h4>Next Steps</h4>
            <ol>${(data.next_steps || []).map(s => `<li>${s}</li>`).join('')}</ol>
          `;
        } catch (err) {
          resultDiv.innerHTML = `<p class="error">Request failed: ${err}</p>`;
        }
      });
    });
  </script>
</body>
</html>
